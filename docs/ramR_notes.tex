% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{book}
\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{ifxetex,ifluatex}
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={Reticular Action Model (RAM) Notation Notes},
  pdfauthor={Ivan Jacob Agaloos Pesigan},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
\usepackage{booktabs}
\usepackage{amsthm}
\usepackage[left = 1in,right = 1in,top = 1in, bottom = 1in]{geometry}
\makeatletter
\def\thm@space@setup{%
  \thm@preskip=8pt plus 2pt minus 4pt
  \thm@postskip=\thm@preskip
}
\makeatother
\ifluatex
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\usepackage[]{natbib}
\bibliographystyle{apalike}

\title{Reticular Action Model (RAM) Notation Notes}
\author{Ivan Jacob Agaloos Pesigan}
\date{2021-01-23}

\usepackage{amsthm}
\newtheorem{theorem}{Theorem}[chapter]
\newtheorem{lemma}{Lemma}[chapter]
\newtheorem{corollary}{Corollary}[chapter]
\newtheorem{proposition}{Proposition}[chapter]
\newtheorem{conjecture}{Conjecture}[chapter]
\theoremstyle{definition}
\newtheorem{definition}{Definition}[chapter]
\theoremstyle{definition}
\newtheorem{example}{Example}[chapter]
\theoremstyle{definition}
\newtheorem{exercise}{Exercise}[chapter]
\theoremstyle{remark}
\newtheorem*{remark}{Remark}
\newtheorem*{solution}{Solution}
\begin{document}
\maketitle

{
\setcounter{tocdepth}{1}
\tableofcontents
}
\hypertarget{description}{%
\chapter{Description}\label{description}}

This is a collection of my notes
on the Reticular Action Model (RAM) notation
that accompanies the \texttt{ramR} package \citep{R-ramR}
in the \texttt{R} statistical environment \citep{R-base}.
You can install the released version of \texttt{ramR}
from \href{https://github.com/jeksterslab/ramR}{GitHub} with:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{remotes}\SpecialCharTok{::}\FunctionTok{install\_github}\NormalTok{(}\StringTok{"jeksterslab/ramR"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

These notes are based on the following resources:

\begin{itemize}
\tightlist
\item
  \citet{Boker-2005}
\item
  \citet{McArdle-1984}
\item
  \citet{McArdle-2005}
\end{itemize}

See \href{https://jeksterslab.github.io/ramR_notes/index.html}{GitHub Pages}
for the html deployment.

\hypertarget{ram-matrix-notation}{%
\chapter{Reticular Action Model (RAM) Matrix Notation}\label{ram-matrix-notation}}

\hypertarget{full-model}{%
\section{Full Model}\label{full-model}}

\begin{definition}
\protect\hypertarget{def:unnamed-chunk-2}{}{\label{def:unnamed-chunk-2} }\begin{equation}
  \mathbf{v}
  =
  \mathbf{A} \mathbf{v} + \mathbf{u}
\end{equation}
\end{definition}

\noindent where

\begin{itemize}
\tightlist
\item
  \(\mathbf{v}\) and \(\mathbf{u}\) are \(t \times 1\) vectors of random variables
\item
  \(\mathbf{A}\) is a \(t \times t\) matrix
  of \emph{directed} or \emph{asymmetric} relationship
  from column variable \(v_j\) to row variable \(v_i\)

  \begin{itemize}
  \tightlist
  \item
    \(\mathbf{A}\) represent the regression
    of each of the \(t\) variables \(\mathbf{v}\) on the other \(t - 1\) variables
  \item
    diagonal \(a_{i,i}\) is zero
  \item
    \(u_i\) represent the residual of \(v_i\)
  \item
    if all regression coefficients on other variables are zero,
    then the variable \(v_i\) is considered the same as its own residual \(u_i\)
  \end{itemize}
\end{itemize}

\begin{definition}
\protect\hypertarget{def:unnamed-chunk-3}{}{\label{def:unnamed-chunk-3} }\begin{equation}
  \mathbf{S}
  =
  \mathbb{E}
  \left\{
    \mathbf{u} \mathbf{u}^{\prime}
  \right\} ,
\end{equation}
\end{definition}

\noindent where

\begin{itemize}
\tightlist
\item
  \(\mathbf{S}\) is a \(t \times t\) matrix
  of \emph{undirected} or \emph{symmetric} relationship

  \begin{itemize}
  \tightlist
  \item
    the notation \(\boldsymbol{\Omega}\) is used in other sources for \(\mathbf{S}\)
  \end{itemize}
\item
  \(\mathbb{E}\) is the expectation operator
\end{itemize}

\begin{definition}
\protect\hypertarget{def:unnamed-chunk-4}{}{\label{def:unnamed-chunk-4} }\begin{equation}
  \mathbf{C}
  =
  \mathbb{E}
  \left\{
    \mathbf{v} \mathbf{v}^{\prime}
  \right\} ,
\end{equation}
\end{definition}

\noindent where

\begin{itemize}
\tightlist
\item
  \(\mathbf{C}\) is a \(t \times t\) variance-covariance matrix

  \begin{itemize}
  \tightlist
  \item
    the notation \(\boldsymbol{\Sigma}\) is used in other sources for \(\mathbf{C}\)
  \end{itemize}
\end{itemize}

\begin{definition}
\protect\hypertarget{def:unnamed-chunk-5}{}{\label{def:unnamed-chunk-5} }\begin{equation*}
  \mathbf{v}
  =
  \mathbf{A} \mathbf{v} + \mathbf{u}
\end{equation*}

\noindent can be rewritten as

\begin{equation}
  \begin{split}
    \mathbf{v} - \mathbf{A} \mathbf{v}
    &=
    \mathbf{u} \\
    \mathbf{u}
    &=
    \mathbf{v} - \mathbf{A} \mathbf{v} \\
    \mathbf{u}
    &=
    \left( \mathbf{I} - \mathbf{A} \right) \mathbf{v}
  \end{split}
\end{equation}

\noindent assuming that \(\left( \mathbf{I} - \mathbf{A} \right)\) is non-singular,

\begin{equation}
  \mathbf{E}
  =
  \left( \mathbf{I} - \mathbf{A} \right)^{-1}
\end{equation}

\noindent then

\begin{equation}
  \begin{split}
    \mathbf{v}
    &=
    \left( \mathbf{I} - \mathbf{A} \right)^{-1} \mathbf{u} \\
    &=
    \mathbf{E} \mathbf{u} .
  \end{split}
\end{equation}
\end{definition}

Using the definitions above,
\(\mathbf{S}\) and \(\mathbf{C}\)
are given by

\begin{equation}
  \begin{split}
    \mathbf{S}
    &=
    \left( \mathbf{I} - \mathbf{A} \right)
    \mathbf{C}
    \left( \mathbf{I} - \mathbf{A} \right)^{-1} \\
    &=
    \mathbf{E}^{-1} \mathbf{C} \left( \mathbf{E}^{-1} \right)^{\mathsf{T}}
    \end{split}
\end{equation}

\begin{equation}
  \begin{split}
    \mathbf{C}
    &=
    \left( \mathbf{I} - \mathbf{A} \right)^{-1}
    \mathbf{S}
    \left[ \left( \mathbf{I} - \mathbf{A} \right)^{-1} \right]^{\mathsf{T}} \\
    &=
    \mathbf{E} \mathbf{S} \mathbf{E}^{\mathsf{T}}
  \end{split}
\end{equation}

\hypertarget{observedmanifestgiven-variables-vs.-unobservedlatenthidden-variables}{%
\section{Observed/Manifest/Given Variables vs.~Unobserved/Latent/Hidden Variables}\label{observedmanifestgiven-variables-vs.-unobservedlatenthidden-variables}}

\begin{definition}
\protect\hypertarget{def:unnamed-chunk-6}{}{\label{def:unnamed-chunk-6} }\begin{equation}
  \mathbf{v}
  =
  \begin{bmatrix}
    \mathbf{g}_{p \times 1} \\
    \mathbf{h}_{q \times 1} \\
  \end{bmatrix}
\end{equation}

\begin{equation}
  t = p + q
\end{equation}
\end{definition}

\begin{itemize}
\tightlist
\item
  \(\mathbf{g}\) may be considered observed, manifest or \emph{given} variables
\item
  \(\mathbf{h}\) may be considered unobserved, latent, or \emph{hidden} variables
\end{itemize}

\begin{definition}
\protect\hypertarget{def:unnamed-chunk-7}{}{\label{def:unnamed-chunk-7} }\begin{equation}
  \mathbf{F}
  =
  \begin{bmatrix}
    \mathbf{I}_{p \times p} : \mathbf{0}_{p \times q}
  \end{bmatrix}
\end{equation}
\end{definition}

\begin{itemize}
\tightlist
\item
  the \(\mathbf{F}\) matrix acts as a \emph{filter} to select the manifest variables
  out of the full set of manifest and latent variables
\end{itemize}

\begin{equation}
  \mathbf{g}
  =
  \mathbf{F}
  \mathbf{v}
\end{equation}

\begin{equation}
  \begin{split}
    \mathbf{g}
    &=
    \mathbf{F} \left( \mathbf{I} - \mathbf{A} \right)^{-1} \mathbf{u} \\
    &=
    \mathbf{F} \mathbf{E} \mathbf{u}
  \end{split}
\end{equation}

\begin{definition}
\protect\hypertarget{def:unnamed-chunk-8}{}{\label{def:unnamed-chunk-8} }\begin{equation}
  \mathbf{M}
  =
  \mathbb{E}
  \left\{
    \mathbf{g}
    \mathbf{g}^{\mathsf{T}}
  \right\}
\end{equation}
\end{definition}

\begin{equation}
  \begin{split}
    \mathbf{M}
    &=
    \mathbf{F}
    \left( \mathbf{I} - \mathbf{A} \right)^{-1}
    \mathbf{S}
    \left[ \left( \mathbf{I} - \mathbf{A} \right)^{-1} \right]^{\mathsf{T}}
    \mathbf{F}^{\mathsf{T}} \\
    &=
    \mathbf{F}
    \mathbf{E} \mathbf{S} \mathbf{E}^{\mathsf{T}}
    \mathbf{F}^{\mathsf{T}} \\
    &=
    \mathbf{F}
    \mathbf{C}
    \mathbf{F}^{\mathsf{T}}
  \end{split}
\end{equation}

\begin{itemize}
\tightlist
\item
  when components of \(\mathbf{v}\) are permuted,
  the columns of \(\mathbf{F}\) can be correspondingly permuted
\item
  the rows and columns of \(\mathbf{C}\) that are filtered out by \(\mathbf{F}\)
  contain useful information about the latent variable structure.
\end{itemize}

The equations above completely define RAM.

\hypertarget{ram-diagram}{%
\chapter{Reticular Action Model (RAM) Path Diagram}\label{ram-diagram}}

\begin{figure}
\centering
\includegraphics{ramR_notes_files/figure-latex/ram-diagram-01-1.pdf}
\caption{\label{fig:ram-diagram-01}Path Diagram Elements}
\end{figure}

\begin{figure}
\centering
\includegraphics{ramR_notes_files/figure-latex/ram-diagram-02-1.pdf}
\caption{\label{fig:ram-diagram-02}Two-Variable Regression Model}
\end{figure}

\begin{figure}
\centering
\includegraphics{ramR_notes_files/figure-latex/ram-diagram-03-1.pdf}
\caption{\label{fig:ram-diagram-03}\(k\)-Variable Regression Model}
\end{figure}

\begin{figure}
\centering
\includegraphics{ramR_notes_files/figure-latex/ram-diagram-04-1.pdf}
\caption{\label{fig:ram-diagram-04}Two-Factor Confirmatory Factor Analysis Model}
\end{figure}

\begin{figure}
\centering
\includegraphics{ramR_notes_files/figure-latex/ram-diagram-05-1.pdf}
\caption{\label{fig:ram-diagram-05}Two-Factor Confirmatory Factor Analysis Model with Mean Structure}
\end{figure}

\begin{figure}
\centering
\includegraphics{ramR_notes_files/figure-latex/ram-diagram-06-1.pdf}
\caption{\label{fig:ram-diagram-06}Path Model with Latent Variables}
\end{figure}

\hypertarget{ram-t}{%
\chapter{\texorpdfstring{Student's \(t\)-test}{Student's t-test}}\label{ram-t}}

In this section,
the Student's \(t\)-test is presented as a structural equation model
using the RAM notation.
Let \(y\) be a continuous dependent variable,
\(x\) be a dichotomous independent variable
\(\left( x = \{0, 1\} \right)\),
and \(\varepsilon\) be the stochastic error term
with mean 0 and constant variance of \(\sigma_{\varepsilon}^{2}\)
across the values of \(x\).
The associations of the variables are given by

\begin{equation*}
  y
  =
  \alpha + \beta x + \varepsilon
\end{equation*}

\noindent where

\begin{itemize}
\tightlist
\item
  \(\alpha\) is the expected value of \(y\) when \(x = 0\)
\item
  \(\beta\) is the unit change in \(y\) for unit change in \(x\)
\item
  \(\alpha + \beta\) is the expected value of \(y\) when \(x = 1\)
\end{itemize}

\begin{figure}
\centering
\includegraphics{ramR_notes_files/figure-latex/ram-t-01-1.pdf}
\caption{\label{fig:ram-t-01}Student's \(t\)-test}
\end{figure}

\hypertarget{symbolic}{%
\section{Symbolic}\label{symbolic}}

Let \(\left\{ y, x, \varepsilon \right\}\) be the variables of interest.

\begin{align*}\mathbf{A} &=\left( \begin{array}{ccc} 0 & \beta  & 1 \\ 0 & 0 & 0 \\ 0 & 0 & 0 \end{array} \right)\end{align*}

\begin{align*}\mathbf{S} &=\left( \begin{array}{ccc} 0 & 0 & 0 \\ 0 & \sigma  _{x} ^{2} & 0 \\ 0 & 0 & \sigma  _{\varepsilon } ^{2} \end{array} \right)\end{align*}

\begin{align*}\mathbf{C} &=\left( \mathbf{I} - \mathbf{A} \right)^{-1} \mathbf{S} \left[ \left( \mathbf{I} - \mathbf{A} \right)^{-1} \right]^{\mathsf{T}} \\\\ &=\mathbf{E} \mathbf{S} \mathbf{E}^{\mathsf{T}} \\\\ &=\left( \begin{array}{ccc} 1 & \beta  & 1 \\ 0 & 1 & 0 \\ 0 & 0 & 1 \end{array} \right)\left( \begin{array}{ccc} 0 & 0 & 0 \\ 0 & \sigma  _{x} ^{2} & 0 \\ 0 & 0 & \sigma  _{\varepsilon } ^{2} \end{array} \right)\left( \begin{array}{ccc} 1 & \beta  & 1 \\ 0 & 1 & 0 \\ 0 & 0 & 1 \end{array} \right)^{\mathsf{T}}\\ &=\left( \begin{array}{ccc} \sigma  _{x} ^{2} \beta  ^{2} + \sigma  _{\varepsilon } ^{2} & \beta  \sigma  _{x} ^{2} & \sigma  _{\varepsilon } ^{2} \\ \sigma  _{x} ^{2} \beta  & \sigma  _{x} ^{2} & 0 \\ \sigma  _{\varepsilon } ^{2} & 0 & \sigma  _{\varepsilon } ^{2} \end{array} \right)\end{align*}

\begin{align*}\mathbf{F} &=\left( \begin{array}{ccc} 1 & 0 & 0 \\ 0 & 1 & 0 \end{array} \right)\end{align*}

\begin{align*}\mathbf{M} &=\mathbf{F} \left( \mathbf{I} - \mathbf{A} \right)^{-1} \mathbf{S} \left[ \left( \mathbf{I} - \mathbf{A} \right)^{-1} \right]^{\mathsf{T}} \mathbf{F}^{\mathsf{T}}\\ &=\mathbf{F} \mathbf{E} \mathbf{S} \mathbf{E}^{\mathsf{T}} \mathbf{F}^{\mathsf{T}} \\\\ &=\mathbf{F} \mathbf{C} \mathbf{F}^{\mathsf{T}} \\\\ &=\left( \begin{array}{ccc} 1 & 0 & 0 \\ 0 & 1 & 0 \end{array} \right)\left( \begin{array}{ccc} \sigma  _{x} ^{2} \beta  ^{2} + \sigma  _{\varepsilon } ^{2} & \beta  \sigma  _{x} ^{2} & \sigma  _{\varepsilon } ^{2} \\ \sigma  _{x} ^{2} \beta  & \sigma  _{x} ^{2} & 0 \\ \sigma  _{\varepsilon } ^{2} & 0 & \sigma  _{\varepsilon } ^{2} \end{array} \right)\left( \begin{array}{ccc} 1 & 0 & 0 \\ 0 & 1 & 0 \end{array} \right)^{\mathsf{T}} \\\\ &=\left( \begin{array}{cc} \sigma  _{x} ^{2} \beta  ^{2} + \sigma  _{\varepsilon } ^{2} & \beta  \sigma  _{x} ^{2} \\ \sigma  _{x} ^{2} \beta  & \sigma  _{x} ^{2} \end{array} \right)\end{align*}

\begin{align*}\mathbf{v} &=\left( \mathbf{I} - \mathbf{A} \right)^{-1} \mathbf{u}\\ &=\left[\left( \begin{array}{ccc} 1 & 0 & 0 \\ 0 & 1 & 0 \\ 0 & 0 & 1 \end{array} \right)-\left( \begin{array}{ccc} 0 & \beta  & 1 \\ 0 & 0 & 0 \\ 0 & 0 & 0 \end{array} \right)\right]^{\mathsf{-1}}\left( \begin{array}{c} \alpha  \\ \mu  _{x} \\ 0 \end{array} \right)\\ &=\left( \begin{array}{c} \alpha  + \beta  \mu  _{x} \\ \mu  _{x} \\ 0 \end{array} \right)\end{align*}

\begin{align*}\mathbf{u} &=\left( \mathbf{I} - \mathbf{A} \right) \mathbf{v}\\ &=\left[\left( \begin{array}{ccc} 1 & 0 & 0 \\ 0 & 1 & 0 \\ 0 & 0 & 1 \end{array} \right)-\left( \begin{array}{ccc} 0 & \beta  & 1 \\ 0 & 0 & 0 \\ 0 & 0 & 0 \end{array} \right)\right]\left( \begin{array}{c} \alpha  + \beta  \mu  _{x} \\ \mu  _{x} \\ 0 \end{array} \right)\\ &=\left( \begin{array}{c} \alpha  \\ \mu  _{x} \\ 0 \end{array} \right)\end{align*}

\begin{align*}\mathbf{g} &=\mathbf{F} \left( \mathbf{I} - \mathbf{A} \right)^{-1} \mathbf{u}\\ &=\left[\left( \begin{array}{ccc} 1 & 0 & 0 \\ 0 & 1 & 0 \\ 0 & 0 & 1 \end{array} \right)-\left( \begin{array}{ccc} 0 & \beta  & 1 \\ 0 & 0 & 0 \\ 0 & 0 & 0 \end{array} \right)\right]^{-1}\left( \begin{array}{c} \alpha  \\ \mu  _{x} \\ 0 \end{array} \right)\\ &=\left( \begin{array}{c} \alpha  + \beta  \mu  _{x} \\ \mu  _{x} \end{array} \right)\end{align*}

\hypertarget{using-the-ramr-package}{%
\subsection{\texorpdfstring{Using the \texttt{ramR} Package}{Using the ramR Package}}\label{using-the-ramr-package}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{A}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   y   x      e  
## y "0" "beta" "1"
## x "0" "0"    "0"
## e "0" "0"    "0"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{S}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   y   x            e                    
## y "0" "0"          "0"                  
## x "0" "sigma[x]^2" "0"                  
## e "0" "0"          "sigma[varepsilon]^2"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{u}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   u      
## y "alpha"
## x "mu[x]"
## e "0"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{filter}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   y x e
## y 1 0 0
## x 0 1 0
\end{verbatim}

The covariance expectations
can be symbolically derived using the \texttt{ramR::C\_sym()} function.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ramR}\SpecialCharTok{::}\FunctionTok{C\_sym}\NormalTok{(A, S)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## {{sigma[x]^2*beta^2+sigma[varepsilon]^2,                       beta*sigma[x]^2,                   sigma[varepsilon]^2},
##  {                      sigma[x]^2*beta,                            sigma[x]^2,                                     0},
##  {                  sigma[varepsilon]^2,                                     0,                   sigma[varepsilon]^2}}
\end{verbatim}

\begin{equation*}\mathbf{C} =\left( \begin{array}{ccc} \sigma  _{x} ^{2} \beta  ^{2} + \sigma  _{\varepsilon } ^{2} & \beta  \sigma  _{x} ^{2} & \sigma  _{\varepsilon } ^{2} \\ \sigma  _{x} ^{2} \beta  & \sigma  _{x} ^{2} & 0 \\ \sigma  _{\varepsilon } ^{2} & 0 & \sigma  _{\varepsilon } ^{2} \end{array} \right)\end{equation*}

The covariance expectations for the observed variables
can be symbolically derived using the \texttt{ramR::M\_sym()} function.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ramR}\SpecialCharTok{::}\FunctionTok{M\_sym}\NormalTok{(A, S, filter)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## {{sigma[x]^2*beta^2+sigma[varepsilon]^2,                       beta*sigma[x]^2},
##  {                      sigma[x]^2*beta,                            sigma[x]^2}}
\end{verbatim}

\begin{equation*}\mathbf{M} =\left( \begin{array}{cc} \sigma  _{x} ^{2} \beta  ^{2} + \sigma  _{\varepsilon } ^{2} & \beta  \sigma  _{x} ^{2} \\ \sigma  _{x} ^{2} \beta  & \sigma  _{x} ^{2} \end{array} \right)\end{equation*}

The mean expectations
can be symbolically derived using the \texttt{ramR::v\_sym()} function.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ramR}\SpecialCharTok{::}\FunctionTok{v\_sym}\NormalTok{(A, u)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## {{alpha+beta*mu[x]},
##  {           mu[x]},
##  {               0}}
\end{verbatim}

\begin{equation*}\mathbf{v} =\left( \begin{array}{c} \alpha  + \beta  \mu  _{x} \\ \mu  _{x} \\ 0 \end{array} \right)\end{equation*}

The mean expectations for the observed variables
can be symbolically derived using the \texttt{ramR::g\_sym()} function.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ramR}\SpecialCharTok{::}\FunctionTok{g\_sym}\NormalTok{(A, u, filter)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## {{alpha+beta*mu[x]},
##  {           mu[x]}}
\end{verbatim}

\begin{equation*}\mathbf{g} =\left( \begin{array}{c} \alpha  + \beta  \mu  _{x} \\ \mu  _{x} \end{array} \right)\end{equation*}

\hypertarget{numerical-example}{%
\section{Numerical Example}\label{numerical-example}}

Let \texttt{df} be a random sample with the following parameters

\begin{tabular}{l|l|l}
\hline
Parameter & $x = 0$ & $x = 1$\\
\hline
Sample Size & 500 & 500\\
\hline
$\mu$ & 0 & 1\\
\hline
$\sigma^2$ & 1 & 1\\
\hline
\end{tabular}

\begin{tabular}{l|l|l}
\hline
Parameter & Description & Estimate\\
\hline
$\alpha$ & Mean of $x = 0$. & 0\\
\hline
$\beta$ & Mean of $x = 1$ minus $x = 0$. & 1\\
\hline
\end{tabular}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{head}\NormalTok{(df)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##            y x
## 1  1.3709584 0
## 2 -0.5646982 0
## 3  0.3631284 0
## 4  0.6328626 0
## 5  0.4042683 0
## 6 -0.1061245 0
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(df)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##        y                 x      
##  Min.   :-2.9931   Min.   :0.0  
##  1st Qu.:-0.2770   1st Qu.:0.0  
##  Median : 0.4503   Median :0.5  
##  Mean   : 0.4742   Mean   :0.5  
##  3rd Qu.: 1.2492   3rd Qu.:1.0  
##  Max.   : 4.4953   Max.   :1.0
\end{verbatim}

\includegraphics{ramR_notes_files/figure-latex/unnamed-chunk-34-1.pdf}

\includegraphics{ramR_notes_files/figure-latex/unnamed-chunk-35-1.pdf}

\includegraphics{ramR_notes_files/figure-latex/unnamed-chunk-36-1.pdf}

\hypertarget{t-test}{%
\subsection{\texorpdfstring{\(t\)-test}{t-test}}\label{t-test}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{t.test}\NormalTok{(y }\SpecialCharTok{\textasciitilde{}}\NormalTok{ x, }\AttributeTok{data =}\NormalTok{ df)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  Welch Two Sample t-test
## 
## data:  y by x
## t = -15.897, df = 994.36, p-value < 2.2e-16
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -1.1329278 -0.8839594
## sample estimates:
## mean in group 0 mean in group 1 
##     -0.03004622      0.97839737
\end{verbatim}

\hypertarget{linear-regression}{%
\subsection{Linear Regression}\label{linear-regression}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(}\FunctionTok{lm}\NormalTok{(y }\SpecialCharTok{\textasciitilde{}}\NormalTok{ x, }\AttributeTok{data =}\NormalTok{ df))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = y ~ x, data = df)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.3501 -0.6517  0.0086  0.6858  3.5169 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)    
## (Intercept) -0.03005    0.04486   -0.67    0.503    
## x            1.00844    0.06344   15.90   <2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 1.003 on 998 degrees of freedom
## Multiple R-squared:  0.2021, Adjusted R-squared:  0.2013 
## F-statistic: 252.7 on 1 and 998 DF,  p-value: < 2.2e-16
\end{verbatim}

\hypertarget{structural-equation-modeling}{%
\subsection{Structural Equation Modeling}\label{structural-equation-modeling}}

\hypertarget{lavaan-lavaan2012}{%
\subsubsection{\texorpdfstring{lavaan \citep{lavaan2012}}{lavaan {[}@lavaan2012{]}}}\label{lavaan-lavaan2012}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{model }\OtherTok{\textless{}{-}} \StringTok{"}
\StringTok{  y \textasciitilde{} x}
\StringTok{"}
\NormalTok{fit }\OtherTok{\textless{}{-}}\NormalTok{ lavaan}\SpecialCharTok{::}\FunctionTok{sem}\NormalTok{(}
\NormalTok{  model,}
  \AttributeTok{data =}\NormalTok{ df,}
  \AttributeTok{meanstructure =} \ConstantTok{TRUE}\NormalTok{,}
  \AttributeTok{fixed.x =} \ConstantTok{FALSE}
\NormalTok{)}
\NormalTok{lavaan}\SpecialCharTok{::}\FunctionTok{summary}\NormalTok{(fit)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## lavaan 0.6-7 ended normally after 12 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of free parameters                          5
##                                                       
##   Number of observations                          1000
##                                                       
## Model Test User Model:
##                                                       
##   Test statistic                                 0.000
##   Degrees of freedom                                 0
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Expected
##   Information saturated (h1) model          Structured
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(>|z|)
##   y ~                                                 
##     x                 1.008    0.063   15.913    0.000
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(>|z|)
##    .y                -0.030    0.045   -0.671    0.503
##     x                 0.500    0.016   31.623    0.000
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(>|z|)
##    .y                 1.004    0.045   22.361    0.000
##     x                 0.250    0.011   22.361    0.000
\end{verbatim}

\hypertarget{openmx-openmx2020}{%
\subsubsection{\texorpdfstring{OpenMx \citep{OpenMx2020}}{OpenMx {[}@OpenMx2020{]}}}\label{openmx-openmx2020}}

RAM matrices can be used to specify models in \texttt{OpenMx}.
Note, however, that the \texttt{u} vector in the RAM notation is
\texttt{M} in the \texttt{OpenMx} notation.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mxData }\OtherTok{\textless{}{-}}\NormalTok{ OpenMx}\SpecialCharTok{::}\FunctionTok{mxData}\NormalTok{(}
  \AttributeTok{observed =}\NormalTok{ df,}
  \AttributeTok{type =} \StringTok{"raw"}
\NormalTok{)}
\NormalTok{mxA }\OtherTok{\textless{}{-}}\NormalTok{ OpenMx}\SpecialCharTok{::}\FunctionTok{mxMatrix}\NormalTok{(}
  \AttributeTok{type =} \StringTok{"Full"}\NormalTok{,}
  \AttributeTok{nrow =} \DecValTok{3}\NormalTok{,}
  \AttributeTok{ncol =} \DecValTok{3}\NormalTok{,}
  \AttributeTok{free =} \FunctionTok{c}\NormalTok{(}
\NormalTok{    F, T, F,}
\NormalTok{    F, F, F,}
\NormalTok{    F, F, F}
\NormalTok{  ),}
  \AttributeTok{values =} \FunctionTok{c}\NormalTok{(}
    \DecValTok{0}\NormalTok{, }\FloatTok{0.20}\NormalTok{, }\DecValTok{1}\NormalTok{,}
    \DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{,}
    \DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}
\NormalTok{  ),}
  \AttributeTok{labels =} \FunctionTok{c}\NormalTok{(}
    \ConstantTok{NA}\NormalTok{, }\StringTok{"beta"}\NormalTok{, }\ConstantTok{NA}\NormalTok{,}
    \ConstantTok{NA}\NormalTok{, }\ConstantTok{NA}\NormalTok{, }\ConstantTok{NA}\NormalTok{,}
    \ConstantTok{NA}\NormalTok{, }\ConstantTok{NA}\NormalTok{, }\ConstantTok{NA}
\NormalTok{  ),}
  \AttributeTok{byrow =} \ConstantTok{TRUE}\NormalTok{,}
  \AttributeTok{name =} \StringTok{"mxA"}
\NormalTok{)}
\NormalTok{mxS }\OtherTok{\textless{}{-}}\NormalTok{ OpenMx}\SpecialCharTok{::}\FunctionTok{mxMatrix}\NormalTok{(}
  \AttributeTok{type =} \StringTok{"Symm"}\NormalTok{,}
  \AttributeTok{nrow =} \DecValTok{3}\NormalTok{,}
  \AttributeTok{ncol =} \DecValTok{3}\NormalTok{,}
  \AttributeTok{free =} \FunctionTok{c}\NormalTok{(}
\NormalTok{    F, F, F,}
\NormalTok{    F, T, F,}
\NormalTok{    F, F, T}
\NormalTok{  ),}
  \AttributeTok{values =} \FunctionTok{c}\NormalTok{(}
    \DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{,}
    \DecValTok{0}\NormalTok{, }\FloatTok{0.20}\NormalTok{, }\DecValTok{0}\NormalTok{,}
    \DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\FloatTok{0.20}
\NormalTok{  ),}
  \AttributeTok{labels =} \FunctionTok{c}\NormalTok{(}
    \ConstantTok{NA}\NormalTok{, }\ConstantTok{NA}\NormalTok{, }\ConstantTok{NA}\NormalTok{,}
    \ConstantTok{NA}\NormalTok{, }\StringTok{"sigma2x"}\NormalTok{, }\ConstantTok{NA}\NormalTok{,}
    \ConstantTok{NA}\NormalTok{, }\ConstantTok{NA}\NormalTok{, }\StringTok{"sigma2e"}
\NormalTok{  ),}
  \AttributeTok{byrow =} \ConstantTok{TRUE}\NormalTok{,}
  \AttributeTok{name =} \StringTok{"mxS"}
\NormalTok{)}
\NormalTok{mxM }\OtherTok{\textless{}{-}}\NormalTok{ OpenMx}\SpecialCharTok{::}\FunctionTok{mxMatrix}\NormalTok{(}
  \AttributeTok{type =} \StringTok{"Full"}\NormalTok{,}
  \AttributeTok{nrow =} \DecValTok{1}\NormalTok{,}
  \AttributeTok{ncol =} \DecValTok{3}\NormalTok{,}
  \AttributeTok{free =} \FunctionTok{c}\NormalTok{(}
\NormalTok{    T, T, F}
\NormalTok{  ),}
  \AttributeTok{values =} \FunctionTok{c}\NormalTok{(}
    \FloatTok{0.20}\NormalTok{,}
    \FloatTok{0.20}\NormalTok{,}
    \DecValTok{0}
\NormalTok{  ),}
  \AttributeTok{labels =} \FunctionTok{c}\NormalTok{(}
    \StringTok{"alpha"}\NormalTok{,}
    \StringTok{"mux"}\NormalTok{,}
    \ConstantTok{NA}
\NormalTok{  ),}
  \AttributeTok{byrow =} \ConstantTok{TRUE}\NormalTok{,}
  \AttributeTok{name =} \StringTok{"mxM"}
\NormalTok{)}
\NormalTok{mxF }\OtherTok{\textless{}{-}}\NormalTok{ OpenMx}\SpecialCharTok{::}\FunctionTok{mxMatrix}\NormalTok{(}
  \AttributeTok{type =} \StringTok{"Full"}\NormalTok{,}
  \AttributeTok{nrow =} \DecValTok{2}\NormalTok{,}
  \AttributeTok{ncol =} \DecValTok{3}\NormalTok{,}
  \AttributeTok{free =} \ConstantTok{FALSE}\NormalTok{,}
  \AttributeTok{values =} \FunctionTok{c}\NormalTok{(}
    \DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{,}
    \DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}
\NormalTok{  ),}
  \AttributeTok{byrow =} \ConstantTok{TRUE}\NormalTok{,}
  \AttributeTok{name =} \StringTok{"mxF"}
\NormalTok{)}
\NormalTok{expRAM }\OtherTok{\textless{}{-}}\NormalTok{ OpenMx}\SpecialCharTok{::}\FunctionTok{mxExpectationRAM}\NormalTok{(}
  \AttributeTok{A =} \StringTok{"mxA"}\NormalTok{,}
  \AttributeTok{S =} \StringTok{"mxS"}\NormalTok{,}
  \AttributeTok{F =} \StringTok{"mxF"}\NormalTok{,}
  \AttributeTok{M =} \StringTok{"mxM"}\NormalTok{,}
  \AttributeTok{dimnames =} \FunctionTok{c}\NormalTok{(}
    \StringTok{"y"}\NormalTok{,}
    \StringTok{"x"}\NormalTok{,}
    \StringTok{"e"}
\NormalTok{  )}
\NormalTok{)}
\NormalTok{objML }\OtherTok{\textless{}{-}}\NormalTok{ OpenMx}\SpecialCharTok{::}\FunctionTok{mxFitFunctionML}\NormalTok{()}
\NormalTok{mxMod }\OtherTok{\textless{}{-}}\NormalTok{ OpenMx}\SpecialCharTok{::}\FunctionTok{mxModel}\NormalTok{(}
  \AttributeTok{name =} \StringTok{"Student\textquotesingle{}s t test"}\NormalTok{,}
  \AttributeTok{data =}\NormalTok{ mxData,}
  \AttributeTok{matrices =} \FunctionTok{list}\NormalTok{(}
\NormalTok{    mxA,}
\NormalTok{    mxS,}
\NormalTok{    mxF,}
\NormalTok{    mxM}
\NormalTok{  ),}
  \AttributeTok{expectation =}\NormalTok{ expRAM,}
  \AttributeTok{fitfunction =}\NormalTok{ objML}
\NormalTok{)}
\NormalTok{fit }\OtherTok{\textless{}{-}}\NormalTok{ OpenMx}\SpecialCharTok{::}\FunctionTok{mxRun}\NormalTok{(mxMod)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Running Student's t test with 5 parameters
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(fit)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Summary of Student's t test 
##  
## free parameters:
##      name matrix row col    Estimate  Std.Error A
## 1    beta    mxA   1   2  1.00844356 0.06337369  
## 2 sigma2x    mxS   2   2  0.25000000 0.01118034  
## 3 sigma2e    mxS   3   3  1.00402596 0.04490152  
## 4   alpha    mxM   1   y -0.03004621 0.04481202  
## 5     mux    mxM   1   x  0.49999999 0.01581140  
## 
## Model Statistics: 
##                |  Parameters  |  Degrees of Freedom  |  Fit (-2lnL units)
##        Model:              5                   1995              4293.478
##    Saturated:              5                   1995                    NA
## Independence:              4                   1996                    NA
## Number of observations/statistics: 1000/2000
## 
## Information Criteria: 
##       |  df Penalty  |  Parameters Penalty  |  Sample-Size Adjusted
## AIC:       303.4776               4303.478                 4303.538
## BIC:     -9487.4941               4328.016                 4312.136
## CFI: NA 
## TLI: 1   (also known as NNFI) 
## RMSEA:  0  [95% CI (NA, NA)]
## Prob(RMSEA <= 0.05): NA
## To get additional fit indices, see help(mxRefModels)
## timestamp: 2021-01-23 23:50:42 
## Wall clock time: 0.03864098 secs 
## optimizer:  SLSQP 
## OpenMx version number: 2.18.1 
## Need help?  See help(mxSummary)
\end{verbatim}

\hypertarget{using-the-ramr-package-1}{%
\subsection{\texorpdfstring{Using the \texttt{ramR} Package}{Using the ramR Package}}\label{using-the-ramr-package-1}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{A}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   y        x e
## y 0 1.008444 1
## x 0 0.000000 0
## e 0 0.000000 0
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{S}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   y         x        e
## y 0 0.0000000 0.000000
## x 0 0.2502503 0.000000
## e 0 0.0000000 1.006038
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{u}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##             u
## y -0.03004622
## x  0.50000000
## e  0.00000000
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{filter}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   y x e
## y 1 0 0
## x 0 1 0
\end{verbatim}

The covariance expectations
can be numerically derived using the \texttt{ramR::C\_num()} function.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ramR}\SpecialCharTok{::}\FunctionTok{C\_num}\NormalTok{(A, S)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##           y         x        e
## y 1.2605321 0.2523633 1.006038
## x 0.2523633 0.2502503 0.000000
## e 1.0060380 0.0000000 1.006038
\end{verbatim}

The covariance expectations for the observed variables
can be numerically derived using the \texttt{ramR::M\_num()} function.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ramR}\SpecialCharTok{::}\FunctionTok{M\_num}\NormalTok{(A, S, filter)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##           y         x
## y 1.2605321 0.2523633
## x 0.2523633 0.2502503
\end{verbatim}

The mean expectations
can be numerically derived using the \texttt{ramR::v\_num()} function.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ramR}\SpecialCharTok{::}\FunctionTok{v\_num}\NormalTok{(A, u)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##           v
## y 0.4741756
## x 0.5000000
## e 0.0000000
\end{verbatim}

The mean expectations for the observed variables
can be numerically derived using the \texttt{ramR::v\_num()} function.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ramR}\SpecialCharTok{::}\FunctionTok{g\_num}\NormalTok{(A, u, filter)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##           g
## y 0.4741756
## x 0.5000000
\end{verbatim}

\hypertarget{equations-to-ram}{%
\section{Equations to RAM}\label{equations-to-ram}}

The \texttt{ramR} package has a utility function
to convert structural equations to RAM notation.
The Student's \(t\)-test can be expressed in the following equations

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{eq }\OtherTok{\textless{}{-}} \StringTok{"}
\StringTok{  \# VARIABLE1 OPERATION VARIABLE2 LABEL}
\StringTok{  e           by        y         1}
\StringTok{  y           on        x         beta}
\StringTok{  e           with      e         sigma[varepsilon]\^{}2}
\StringTok{  x           with      x         sigma[x]\^{}2}
\StringTok{  y           on        1         alpha}
\StringTok{  x           on        1         mu[x]}
\StringTok{"}
\end{Highlighting}
\end{Shaded}

\begin{figure}
\centering
\includegraphics{ramR_notes_files/figure-latex/ram-t-02-1.pdf}
\caption{\label{fig:ram-t-02}Student's \(t\)-test's Structural Equations}
\end{figure}

The error term is treated as a latent variable
and defined with the operation \texttt{by}.
Its value is constrained to \(1\).
The regression of \(y\) on \(x\) is defined by operation \texttt{on}.
It is labeled as \texttt{beta}.
The variance of \(x\) and the error variance
are defined using the operation \texttt{with}.
These are labeled \texttt{sigma{[}x{]}\^{}2} and \texttt{sigma{[}varepsilon{]}\^{}2} respectively.
The intercept and the mean of \(x\) are defined using the operation \texttt{on\ 1}.
These are labeled \texttt{alpha} and \texttt{mu{[}x{]}} respectively.

The \texttt{ramR::eq2ram} converts the equations to RAM notation.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ramR}\SpecialCharTok{::}\FunctionTok{eq2ram}\NormalTok{(eq)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## $eq
##   var1   op var2               label
## 1    e   by    y                   1
## 2    y   on    x                beta
## 3    e with    e sigma[varepsilon]^2
## 4    x with    x          sigma[x]^2
## 5    y   on    1               alpha
## 6    x   on    1               mu[x]
## 
## $variables
## [1] "y" "x" "e"
## 
## $A
##   y   x      e  
## y "0" "beta" "1"
## x "0" "0"    "0"
## e "0" "0"    "0"
## 
## $S
##   y   x            e                    
## y "0" "0"          "0"                  
## x "0" "sigma[x]^2" "0"                  
## e "0" "0"          "sigma[varepsilon]^2"
## 
## $filter
##   y x e
## y 1 0 0
## x 0 1 0
## 
## $u
##   u      
## y "alpha"
## x "mu[x]"
## e "0"
\end{verbatim}

\hypertarget{equations-to-expectations}{%
\section{Equations to Expectations}\label{equations-to-expectations}}

The \texttt{ramR} package has a utility function
to convert structural equations to expectations
both symbolically and numerically.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{eq }\OtherTok{\textless{}{-}} \StringTok{"}
\StringTok{  \# VARIABLE1 OPERATION VARIABLE2 LABEL}
\StringTok{  e           by        y         1}
\StringTok{  y           on        x         beta}
\StringTok{  e           with      e         sigma[varepsilon]\^{}2}
\StringTok{  x           with      x         sigma[x]\^{}2}
\StringTok{  y           on        1         alpha}
\StringTok{  x           on        1         mu[x]}
\StringTok{"}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ramR}\SpecialCharTok{::}\FunctionTok{eq2exp\_sym}\NormalTok{(eq)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## $variables
## [1] "y" "x" "e"
## 
## $A
## {{   0, beta,    1},
##  {   0,    0,    0},
##  {   0,    0,    0}} 
## 
## $S
## {{                  0,                   0,                   0},
##  {                  0,          sigma[x]^2,                   0},
##  {                  0,                   0, sigma[varepsilon]^2}} 
## 
## $u
## {{alpha},
##  {mu[x]},
##  {    0}} 
## 
## $filter
## {{1, 0, 0},
##  {0, 1, 0}} 
## 
## $v
## {{alpha+beta*mu[x]},
##  {           mu[x]},
##  {               0}} 
## 
## $g
## {{alpha+beta*mu[x]},
##  {           mu[x]}} 
## 
## $C
## {{sigma[x]^2*beta^2+sigma[varepsilon]^2,                       beta*sigma[x]^2,                   sigma[varepsilon]^2},
##  {                      sigma[x]^2*beta,                            sigma[x]^2,                                     0},
##  {                  sigma[varepsilon]^2,                                     0,                   sigma[varepsilon]^2}} 
## 
## $M
## {{sigma[x]^2*beta^2+sigma[varepsilon]^2,                       beta*sigma[x]^2},
##  {                      sigma[x]^2*beta,                            sigma[x]^2}}
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{eq }\OtherTok{\textless{}{-}} \StringTok{"}
\StringTok{  \# VARIABLE1 OPERATION VARIABLE2 VALUE}
\StringTok{  e           by        y         1.00}
\StringTok{  y           on        x         1.00}
\StringTok{  e           with      e         1.00}
\StringTok{  x           with      x         0.25}
\StringTok{  y           on        1         0.00}
\StringTok{  x           on        1         0.50}
\StringTok{"}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ramR}\SpecialCharTok{::}\FunctionTok{eq2exp\_num}\NormalTok{(eq)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## $variables
## [1] "y" "x" "e"
## 
## $A
##   y x e
## y 0 1 1
## x 0 0 0
## e 0 0 0
## 
## $S
##   y    x e
## y 0 0.00 0
## x 0 0.25 0
## e 0 0.00 1
## 
## $u
##     u
## y 0.0
## x 0.5
## e 0.0
## 
## $filter
##   y x e
## y 1 0 0
## x 0 1 0
## 
## $v
##     v
## y 0.5
## x 0.5
## e 0.0
## 
## $g
##     g
## y 0.5
## x 0.5
## 
## $C
##      y    x e
## y 1.25 0.25 1
## x 0.25 0.25 0
## e 1.00 0.00 1
## 
## $M
##      y    x
## y 1.25 0.25
## x 0.25 0.25
\end{verbatim}

\hypertarget{ram-anova}{%
\chapter{One-Way Analysis of Variance}\label{ram-anova}}

In this section,
one-way analysis of variance is presented as a structural equation model
using the RAM notation.
Let \(y\) be a continuous dependent variable,
\(x\) be a categorical independent variable
with three levels
\(\left( x = \{0, 1, 2\} \right)\).
The dependent variable \(x\) can be dummy coded as

\begin{tabular}{l|l|l}
\hline
$x$ & $x_1$ & $x_2$\\
\hline
$x = 0$ & 0 & 0\\
\hline
$x = 1$ & 1 & 0\\
\hline
$x = 2$ & 0 & 1\\
\hline
\end{tabular}

The associations of the variables are given by

\begin{equation*}
  y
  =
  \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \varepsilon
\end{equation*}

\noindent where

\begin{itemize}
\tightlist
\item
  \(\beta_0\) is the expected value of \(y\) when \(x = 0\)
\item
  \(\beta_1\) is the unit change in \(y\) for unit change in \(x_1\) while \(x_2\) is constant
\item
  \(\beta_2\) is the unit change in \(y\) for unit change in \(x_2\) while \(x_1\) is constant
\item
  \(\beta_0 + \beta_1\) is the expected value of \(y\) when \(x = 1\)
\item
  \(\beta_0 + \beta_2\) is the expected value of \(y\) when \(x = 2\)
\end{itemize}

\begin{figure}
\centering
\includegraphics{ramR_notes_files/figure-latex/ram-aov-01-1.pdf}
\caption{\label{fig:ram-aov-01}One-Way Analysis of Variance}
\end{figure}

\hypertarget{symbolic-1}{%
\section{Symbolic}\label{symbolic-1}}

Let \(\left\{ y, x_1, x_2, \varepsilon \right\}\) be the variables of interest.

\begin{align*}\mathbf{A} &=\left( \begin{array}{cccc} 0 & \beta  _{1} & \beta  _{2} & 1 \\ 0 & 0 & 0 & 0 \\ 0 & 0 & 0 & 0 \\ 0 & 0 & 0 & 0 \end{array} \right)\end{align*}

\begin{align*}\mathbf{S} &=\left( \begin{array}{cccc} 0 & 0 & 0 & 0 \\ 0 & \sigma  _{x_{1}} ^{2} & 0 & 0 \\ 0 & 0 & \sigma  _{x_{2}} ^{2} & 0 \\ 0 & 0 & 0 & \sigma  _{\varepsilon } ^{2} \end{array} \right)\end{align*}

\begin{align*}\mathbf{C} &=\left( \mathbf{I} - \mathbf{A} \right)^{-1} \mathbf{S} \left[ \left( \mathbf{I} - \mathbf{A} \right)^{-1} \right]^{\mathsf{T}} \\\\ &=\mathbf{E} \mathbf{S} \mathbf{E}^{\mathsf{T}} \\\\ &=\left( \begin{array}{cccc} 1 & \beta  _{1} & \beta  _{2} & 1 \\ 0 & 1 & 0 & 0 \\ 0 & 0 & 1 & 0 \\ 0 & 0 & 0 & 1 \end{array} \right)\left( \begin{array}{cccc} 0 & 0 & 0 & 0 \\ 0 & \sigma  _{x_{1}} ^{2} & 0 & 0 \\ 0 & 0 & \sigma  _{x_{2}} ^{2} & 0 \\ 0 & 0 & 0 & \sigma  _{\varepsilon } ^{2} \end{array} \right)\left( \begin{array}{cccc} 1 & \beta  _{1} & \beta  _{2} & 1 \\ 0 & 1 & 0 & 0 \\ 0 & 0 & 1 & 0 \\ 0 & 0 & 0 & 1 \end{array} \right)^{\mathsf{T}}\\ &=\left( \begin{array}{cccc} \sigma  _{x_{1}} ^{2} \beta  _{1} ^{2} + \sigma  _{x_{2}} ^{2} \beta  _{2} ^{2} + \sigma  _{\varepsilon } ^{2} & \beta  _{1} \sigma  _{x_{1}} ^{2} & \beta  _{2} \sigma  _{x_{2}} ^{2} & \sigma  _{\varepsilon } ^{2} \\ \sigma  _{x_{1}} ^{2} \beta  _{1} & \sigma  _{x_{1}} ^{2} & 0 & 0 \\ \sigma  _{x_{2}} ^{2} \beta  _{2} & 0 & \sigma  _{x_{2}} ^{2} & 0 \\ \sigma  _{\varepsilon } ^{2} & 0 & 0 & \sigma  _{\varepsilon } ^{2} \end{array} \right)\end{align*}

\begin{align*}\mathbf{F} &=\left( \begin{array}{cccc} 1 & 0 & 0 & 0 \\ 0 & 1 & 0 & 0 \\ 0 & 0 & 1 & 0 \end{array} \right)\end{align*}

\begin{align*}\mathbf{M} &=\mathbf{F} \left( \mathbf{I} - \mathbf{A} \right)^{-1} \mathbf{S} \left[ \left( \mathbf{I} - \mathbf{A} \right)^{-1} \right]^{\mathsf{T}} \mathbf{F}^{\mathsf{T}}\\ &=\mathbf{F} \mathbf{E} \mathbf{S} \mathbf{E}^{\mathsf{T}} \mathbf{F}^{\mathsf{T}} \\\\ &=\mathbf{F} \mathbf{C} \mathbf{F}^{\mathsf{T}} \\\\ &=\left( \begin{array}{cccc} 1 & 0 & 0 & 0 \\ 0 & 1 & 0 & 0 \\ 0 & 0 & 1 & 0 \end{array} \right)\left( \begin{array}{cccc} \sigma  _{x_{1}} ^{2} \beta  _{1} ^{2} + \sigma  _{x_{2}} ^{2} \beta  _{2} ^{2} + \sigma  _{\varepsilon } ^{2} & \beta  _{1} \sigma  _{x_{1}} ^{2} & \beta  _{2} \sigma  _{x_{2}} ^{2} & \sigma  _{\varepsilon } ^{2} \\ \sigma  _{x_{1}} ^{2} \beta  _{1} & \sigma  _{x_{1}} ^{2} & 0 & 0 \\ \sigma  _{x_{2}} ^{2} \beta  _{2} & 0 & \sigma  _{x_{2}} ^{2} & 0 \\ \sigma  _{\varepsilon } ^{2} & 0 & 0 & \sigma  _{\varepsilon } ^{2} \end{array} \right)\left( \begin{array}{cccc} 1 & 0 & 0 & 0 \\ 0 & 1 & 0 & 0 \\ 0 & 0 & 1 & 0 \end{array} \right)^{\mathsf{T}} \\\\ &=\left( \begin{array}{ccc} \sigma  _{x_{1}} ^{2} \beta  _{1} ^{2} + \sigma  _{x_{2}} ^{2} \beta  _{2} ^{2} + \sigma  _{\varepsilon } ^{2} & \beta  _{1} \sigma  _{x_{1}} ^{2} & \beta  _{2} \sigma  _{x_{2}} ^{2} \\ \sigma  _{x_{1}} ^{2} \beta  _{1} & \sigma  _{x_{1}} ^{2} & 0 \\ \sigma  _{x_{2}} ^{2} \beta  _{2} & 0 & \sigma  _{x_{2}} ^{2} \end{array} \right)\end{align*}

\begin{align*}\mathbf{v} &=\left( \mathbf{I} - \mathbf{A} \right)^{-1} \mathbf{u}\\ &=\left[\left( \begin{array}{cccc} 1 & 0 & 0 & 0 \\ 0 & 1 & 0 & 0 \\ 0 & 0 & 1 & 0 \\ 0 & 0 & 0 & 1 \end{array} \right)-\left( \begin{array}{cccc} 0 & \beta  _{1} & \beta  _{2} & 1 \\ 0 & 0 & 0 & 0 \\ 0 & 0 & 0 & 0 \\ 0 & 0 & 0 & 0 \end{array} \right)\right]^{\mathsf{-1}}\left( \begin{array}{c} \beta  _{0} \\ \mu  _{x_{1}} \\ \mu  _{x_{2}} \\ 0 \end{array} \right)\\ &=\left( \begin{array}{c} \beta  _{0} + \beta  _{1} \mu  _{x_{1}} + \beta  _{2} \mu  _{x_{2}} \\ \mu  _{x_{1}} \\ \mu  _{x_{2}} \\ 0 \end{array} \right)\end{align*}

\begin{align*}\mathbf{u} &=\left( \mathbf{I} - \mathbf{A} \right) \mathbf{v}\\ &=\left[\left( \begin{array}{cccc} 1 & 0 & 0 & 0 \\ 0 & 1 & 0 & 0 \\ 0 & 0 & 1 & 0 \\ 0 & 0 & 0 & 1 \end{array} \right)-\left( \begin{array}{cccc} 0 & \beta  _{1} & \beta  _{2} & 1 \\ 0 & 0 & 0 & 0 \\ 0 & 0 & 0 & 0 \\ 0 & 0 & 0 & 0 \end{array} \right)\right]\left( \begin{array}{c} \beta  _{0} + \beta  _{1} \mu  _{x_{1}} + \beta  _{2} \mu  _{x_{2}} \\ \mu  _{x_{1}} \\ \mu  _{x_{2}} \\ 0 \end{array} \right)\\ &=\left( \begin{array}{c} \beta  _{0} \\ \mu  _{x_{1}} \\ \mu  _{x_{2}} \\ 0 \end{array} \right)\end{align*}

\begin{align*}\mathbf{g} &=\mathbf{F} \left( \mathbf{I} - \mathbf{A} \right)^{-1} \mathbf{u}\\ &=\left[\left( \begin{array}{cccc} 1 & 0 & 0 & 0 \\ 0 & 1 & 0 & 0 \\ 0 & 0 & 1 & 0 \\ 0 & 0 & 0 & 1 \end{array} \right)-\left( \begin{array}{cccc} 0 & \beta  _{1} & \beta  _{2} & 1 \\ 0 & 0 & 0 & 0 \\ 0 & 0 & 0 & 0 \\ 0 & 0 & 0 & 0 \end{array} \right)\right]^{-1}\left( \begin{array}{c} \beta  _{0} \\ \mu  _{x_{1}} \\ \mu  _{x_{2}} \\ 0 \end{array} \right)\\ &=\left( \begin{array}{c} \beta  _{0} + \beta  _{1} \mu  _{x_{1}} + \beta  _{2} \mu  _{x_{2}} \\ \mu  _{x_{1}} \\ \mu  _{x_{2}} \end{array} \right)\end{align*}

\hypertarget{using-the-ramr-package-2}{%
\subsection{\texorpdfstring{Using the \texttt{ramR} Package}{Using the ramR Package}}\label{using-the-ramr-package-2}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{A}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    y   x1        x2        e  
## y  "0" "beta[1]" "beta[2]" "1"
## x1 "0" "0"       "0"       "0"
## x2 "0" "0"       "0"       "0"
## e  "0" "0"       "0"       "0"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{S}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    y   x1            x2            e                    
## y  "0" "0"           "0"           "0"                  
## x1 "0" "sigma[x1]^2" "0"           "0"                  
## x2 "0" "0"           "sigma[x2]^2" "0"                  
## e  "0" "0"           "0"           "sigma[varepsilon]^2"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{u}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    u        
## y  "beta[0]"
## x1 "mu[x1]" 
## x2 "mu[x2]" 
## e  "0"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{filter}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    y x1 x2 e
## y  1  0  0 0
## x1 0  1  0 0
## x2 0  0  1 0
\end{verbatim}

The covariance expectations
can be symbolically derived using the \texttt{ramR::C\_sym()} function.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ramR}\SpecialCharTok{::}\FunctionTok{C\_sym}\NormalTok{(A, S)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## {{sigma[x1]^2*beta[1]^2+sigma[x2]^2*beta[2]^2+sigma[varepsilon]^2,                                             beta[1]*sigma[x1]^2,                                             beta[2]*sigma[x2]^2,                                             sigma[varepsilon]^2},
##  {                                            sigma[x1]^2*beta[1],                                                     sigma[x1]^2,                                                               0,                                                               0},
##  {                                            sigma[x2]^2*beta[2],                                                               0,                                                     sigma[x2]^2,                                                               0},
##  {                                            sigma[varepsilon]^2,                                                               0,                                                               0,                                             sigma[varepsilon]^2}}
\end{verbatim}

\begin{equation*}\mathbf{C} =\left( \begin{array}{cccc} \sigma  _{x_{1}} ^{2} \beta  _{1} ^{2} + \sigma  _{x_{2}} ^{2} \beta  _{2} ^{2} + \sigma  _{\varepsilon } ^{2} & \beta  _{1} \sigma  _{x_{1}} ^{2} & \beta  _{2} \sigma  _{x_{2}} ^{2} & \sigma  _{\varepsilon } ^{2} \\ \sigma  _{x_{1}} ^{2} \beta  _{1} & \sigma  _{x_{1}} ^{2} & 0 & 0 \\ \sigma  _{x_{2}} ^{2} \beta  _{2} & 0 & \sigma  _{x_{2}} ^{2} & 0 \\ \sigma  _{\varepsilon } ^{2} & 0 & 0 & \sigma  _{\varepsilon } ^{2} \end{array} \right)\end{equation*}

The covariance expectations for the observed variables
can be symbolically derived using the \texttt{ramR::M\_sym()} function.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ramR}\SpecialCharTok{::}\FunctionTok{M\_sym}\NormalTok{(A, S, filter)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## {{sigma[x1]^2*beta[1]^2+sigma[x2]^2*beta[2]^2+sigma[varepsilon]^2,                                             beta[1]*sigma[x1]^2,                                             beta[2]*sigma[x2]^2},
##  {                                            sigma[x1]^2*beta[1],                                                     sigma[x1]^2,                                                               0},
##  {                                            sigma[x2]^2*beta[2],                                                               0,                                                     sigma[x2]^2}}
\end{verbatim}

\begin{equation*}\mathbf{M} =\left( \begin{array}{ccc} \sigma  _{x_{1}} ^{2} \beta  _{1} ^{2} + \sigma  _{x_{2}} ^{2} \beta  _{2} ^{2} + \sigma  _{\varepsilon } ^{2} & \beta  _{1} \sigma  _{x_{1}} ^{2} & \beta  _{2} \sigma  _{x_{2}} ^{2} \\ \sigma  _{x_{1}} ^{2} \beta  _{1} & \sigma  _{x_{1}} ^{2} & 0 \\ \sigma  _{x_{2}} ^{2} \beta  _{2} & 0 & \sigma  _{x_{2}} ^{2} \end{array} \right)\end{equation*}

The mean expectations
can be symbolically derived using the \texttt{ramR::v\_sym()} function.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ramR}\SpecialCharTok{::}\FunctionTok{v\_sym}\NormalTok{(A, u)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## {{beta[0]+beta[1]*mu[x1]+beta[2]*mu[x2]},
##  {                               mu[x1]},
##  {                               mu[x2]},
##  {                                    0}}
\end{verbatim}

\begin{equation*}\mathbf{v} =\left( \begin{array}{c} \beta  _{0} + \beta  _{1} \mu  _{x_{1}} + \beta  _{2} \mu  _{x_{2}} \\ \mu  _{x_{1}} \\ \mu  _{x_{2}} \\ 0 \end{array} \right)\end{equation*}

The mean expectations for the observed variables
can be symbolically derived using the \texttt{ramR::g\_sym()} function.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ramR}\SpecialCharTok{::}\FunctionTok{g\_sym}\NormalTok{(A, u, filter)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## {{beta[0]+beta[1]*mu[x1]+beta[2]*mu[x2]},
##  {                               mu[x1]},
##  {                               mu[x2]}}
\end{verbatim}

\begin{equation*}\mathbf{g} =\left( \begin{array}{c} \beta  _{0} + \beta  _{1} \mu  _{x_{1}} + \beta  _{2} \mu  _{x_{2}} \\ \mu  _{x_{1}} \\ \mu  _{x_{2}} \end{array} \right)\end{equation*}

\hypertarget{numerical-example-1}{%
\section{Numerical Example}\label{numerical-example-1}}

Let \texttt{df} be a random sample with the following parameters

\begin{tabular}{l|l|l|l}
\hline
Parameter & $x = 0$ & $x = 1$ & $x = 2$\\
\hline
Sample Size & 500 & 500 & 500\\
\hline
$\mu$ & 0 & 2 & 1\\
\hline
$\sigma^2$ & 1 & 1 & 1\\
\hline
\end{tabular}

\begin{tabular}{l|l|l}
\hline
Parameter & Description & Estimate\\
\hline
$\beta_0$ & Mean of $x = 0$. & 0\\
\hline
$\beta_1$ & Mean of $x = 1$ minus $x = 0$. & 2\\
\hline
$\beta_2$ & Mean of $x = 2$ minus $x = 0$. & 1\\
\hline
\end{tabular}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{head}\NormalTok{(df)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##            y x
## 1 -0.6013830 0
## 2 -0.1358161 0
## 3 -0.9872728 0
## 4  0.8319250 0
## 5 -0.7950595 0
## 6  0.3404646 0
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(df)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##        y            x      
##  Min.   :-2.61364   0:500  
##  1st Qu.: 0.08094   1:500  
##  Median : 1.02617   2:500  
##  Mean   : 1.00814          
##  3rd Qu.: 1.90112          
##  Max.   : 5.47091
\end{verbatim}

\includegraphics{ramR_notes_files/figure-latex/unnamed-chunk-81-1.pdf}

\includegraphics{ramR_notes_files/figure-latex/unnamed-chunk-82-1.pdf}

\includegraphics{ramR_notes_files/figure-latex/unnamed-chunk-83-1.pdf}

\includegraphics{ramR_notes_files/figure-latex/unnamed-chunk-84-1.pdf}

\hypertarget{one-way-analysis-of-variance}{%
\subsection{One-Way Analysis of Variance}\label{one-way-analysis-of-variance}}

Make sure that \(x\) is of class \texttt{factor} for \texttt{lm} and \texttt{aov}
to treat it as a categorical variable.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str}\NormalTok{(df)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 'data.frame':    1500 obs. of  2 variables:
##  $ y: num  -0.601 -0.136 -0.987 0.832 -0.795 ...
##  $ x: Factor w/ 3 levels "0","1","2": 1 1 1 1 1 1 1 1 1 1 ...
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(}\FunctionTok{aov}\NormalTok{(y }\SpecialCharTok{\textasciitilde{}}\NormalTok{ x, }\AttributeTok{data =}\NormalTok{ df))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##               Df Sum Sq Mean Sq F value Pr(>F)    
## x              2  983.8   491.9   471.4 <2e-16 ***
## Residuals   1497 1562.2     1.0                   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end{verbatim}

\hypertarget{linear-regression-1}{%
\subsection{Linear Regression}\label{linear-regression-1}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(}\FunctionTok{lm}\NormalTok{(y }\SpecialCharTok{\textasciitilde{}}\NormalTok{ x, }\AttributeTok{data =}\NormalTok{ df))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = y ~ x, data = df)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.1792 -0.6469  0.0021  0.6751  3.5538 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)    
## (Intercept)  0.03083    0.04569   0.675      0.5    
## x1           1.98309    0.06461  30.694   <2e-16 ***
## x2           0.94884    0.06461  14.686   <2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 1.022 on 1497 degrees of freedom
## Multiple R-squared:  0.3864, Adjusted R-squared:  0.3856 
## F-statistic: 471.4 on 2 and 1497 DF,  p-value: < 2.2e-16
\end{verbatim}

\hypertarget{structural-equation-modeling-1}{%
\subsection{Structural Equation Modeling}\label{structural-equation-modeling-1}}

We have to dummy code the data set first before fitting the model.
The \texttt{model.matrix} function which is used to create a design matrix
can be used to dummy code \texttt{x}.
Make sure that \texttt{x} is a \texttt{factor}.
The first column of the design matrix is a matrix of ones.
Since we do not need this column,
we can replace this column with the values of \texttt{y}.
Make sure to name rename the first column
as \texttt{lavaan} relies on the column names.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df\_dummy }\OtherTok{\textless{}{-}} \FunctionTok{model.matrix}\NormalTok{(y }\SpecialCharTok{\textasciitilde{}}\NormalTok{ x, }\AttributeTok{data =}\NormalTok{ df)}
\NormalTok{df\_dummy[, }\DecValTok{1}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ df}\SpecialCharTok{$}\NormalTok{y}
\FunctionTok{colnames}\NormalTok{(df\_dummy)[}\DecValTok{1}\NormalTok{] }\OtherTok{\textless{}{-}} \StringTok{"y"}
\FunctionTok{head}\NormalTok{(df\_dummy)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##            y x1 x2
## 1 -0.6013830  0  0
## 2 -0.1358161  0  0
## 3 -0.9872728  0  0
## 4  0.8319250  0  0
## 5 -0.7950595  0  0
## 6  0.3404646  0  0
\end{verbatim}

\hypertarget{lavaan-lavaan2012-1}{%
\subsubsection{\texorpdfstring{lavaan \citep{lavaan2012}}{lavaan {[}@lavaan2012{]}}}\label{lavaan-lavaan2012-1}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{model }\OtherTok{\textless{}{-}} \StringTok{"}
\StringTok{  y \textasciitilde{} x1 + x2}
\StringTok{"}
\NormalTok{fit }\OtherTok{\textless{}{-}}\NormalTok{ lavaan}\SpecialCharTok{::}\FunctionTok{sem}\NormalTok{(}
\NormalTok{  model,}
  \AttributeTok{data =}\NormalTok{ df\_dummy,}
  \AttributeTok{meanstructure =} \ConstantTok{TRUE}\NormalTok{,}
  \AttributeTok{fixed.x =} \ConstantTok{FALSE}
\NormalTok{)}
\NormalTok{lavaan}\SpecialCharTok{::}\FunctionTok{summary}\NormalTok{(fit)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## lavaan 0.6-7 ended normally after 22 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of free parameters                          9
##                                                       
##   Number of observations                          1500
##                                                       
## Model Test User Model:
##                                                       
##   Test statistic                                 0.000
##   Degrees of freedom                                 0
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Expected
##   Information saturated (h1) model          Structured
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(>|z|)
##   y ~                                                 
##     x1                1.983    0.065   30.725    0.000
##     x2                0.949    0.065   14.701    0.000
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(>|z|)
##   x1 ~~                                               
##     x2               -0.111    0.006  -17.321    0.000
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(>|z|)
##    .y                 0.031    0.046    0.676    0.499
##     x1                0.333    0.012   27.386    0.000
##     x2                0.333    0.012   27.386    0.000
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(>|z|)
##    .y                 1.041    0.038   27.386    0.000
##     x1                0.222    0.008   27.386    0.000
##     x2                0.222    0.008   27.386    0.000
\end{verbatim}

\hypertarget{openmx-openmx2020-1}{%
\subsubsection{\texorpdfstring{OpenMx \citep{OpenMx2020}}{OpenMx {[}@OpenMx2020{]}}}\label{openmx-openmx2020-1}}

RAM matrices can be used to specify models in \texttt{OpenMx}.
Note, however, that the \texttt{u} vector in the RAM notation is
\texttt{M} in the \texttt{OpenMx} notation.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mxData }\OtherTok{\textless{}{-}}\NormalTok{ OpenMx}\SpecialCharTok{::}\FunctionTok{mxData}\NormalTok{(}
  \AttributeTok{observed =}\NormalTok{ df\_dummy,}
  \AttributeTok{type =} \StringTok{"raw"}
\NormalTok{)}
\NormalTok{mxA }\OtherTok{\textless{}{-}}\NormalTok{ OpenMx}\SpecialCharTok{::}\FunctionTok{mxMatrix}\NormalTok{(}
  \AttributeTok{type =} \StringTok{"Full"}\NormalTok{,}
  \AttributeTok{nrow =} \DecValTok{4}\NormalTok{,}
  \AttributeTok{ncol =} \DecValTok{4}\NormalTok{,}
  \AttributeTok{free =} \FunctionTok{c}\NormalTok{(}
\NormalTok{    F, T, T, F,}
\NormalTok{    F, F, F, F,}
\NormalTok{    F, F, F, F,}
\NormalTok{    F, F, F, F}
\NormalTok{  ),}
  \AttributeTok{values =} \FunctionTok{c}\NormalTok{(}
    \DecValTok{0}\NormalTok{, }\FloatTok{0.20}\NormalTok{, }\FloatTok{0.20}\NormalTok{, }\DecValTok{1}\NormalTok{,}
    \DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{,}
    \DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{,}
    \DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}
\NormalTok{  ),}
  \AttributeTok{labels =} \FunctionTok{c}\NormalTok{(}
    \ConstantTok{NA}\NormalTok{, }\StringTok{"beta1"}\NormalTok{, }\StringTok{"beta2"}\NormalTok{, }\ConstantTok{NA}\NormalTok{,}
    \ConstantTok{NA}\NormalTok{, }\ConstantTok{NA}\NormalTok{, }\ConstantTok{NA}\NormalTok{, }\ConstantTok{NA}\NormalTok{,}
    \ConstantTok{NA}\NormalTok{, }\ConstantTok{NA}\NormalTok{, }\ConstantTok{NA}\NormalTok{, }\ConstantTok{NA}\NormalTok{,}
    \ConstantTok{NA}\NormalTok{, }\ConstantTok{NA}\NormalTok{, }\ConstantTok{NA}\NormalTok{, }\ConstantTok{NA}
\NormalTok{  ),}
  \AttributeTok{byrow =} \ConstantTok{TRUE}\NormalTok{,}
  \AttributeTok{name =} \StringTok{"mxA"}
\NormalTok{)}
\NormalTok{mxS }\OtherTok{\textless{}{-}}\NormalTok{ OpenMx}\SpecialCharTok{::}\FunctionTok{mxMatrix}\NormalTok{(}
  \AttributeTok{type =} \StringTok{"Symm"}\NormalTok{,}
  \AttributeTok{nrow =} \DecValTok{4}\NormalTok{,}
  \AttributeTok{ncol =} \DecValTok{4}\NormalTok{,}
  \AttributeTok{free =} \FunctionTok{c}\NormalTok{(}
\NormalTok{    F, F, F, F,}
\NormalTok{    F, T, F, F,}
\NormalTok{    F, F, T, F,}
\NormalTok{    F, F, F, T}
\NormalTok{  ),}
  \AttributeTok{values =} \FunctionTok{c}\NormalTok{(}
    \DecValTok{0}\NormalTok{,    }\DecValTok{0}\NormalTok{,    }\DecValTok{0}\NormalTok{,    }\DecValTok{0}\NormalTok{,}
    \DecValTok{0}\NormalTok{, }\FloatTok{0.20}\NormalTok{,    }\DecValTok{0}\NormalTok{,    }\DecValTok{0}\NormalTok{,}
    \DecValTok{0}\NormalTok{,    }\DecValTok{0}\NormalTok{, }\FloatTok{0.20}\NormalTok{,    }\DecValTok{0}\NormalTok{,}
    \DecValTok{0}\NormalTok{,    }\DecValTok{0}\NormalTok{,    }\DecValTok{0}\NormalTok{, }\FloatTok{0.20}
\NormalTok{  ),}
  \AttributeTok{labels =} \FunctionTok{c}\NormalTok{(}
    \ConstantTok{NA}\NormalTok{, }\ConstantTok{NA}\NormalTok{, }\ConstantTok{NA}\NormalTok{, }\ConstantTok{NA}\NormalTok{,}
    \ConstantTok{NA}\NormalTok{, }\StringTok{"sigma2x1"}\NormalTok{, }\ConstantTok{NA}\NormalTok{, }\ConstantTok{NA}\NormalTok{,}
    \ConstantTok{NA}\NormalTok{, }\ConstantTok{NA}\NormalTok{, }\StringTok{"sigma2x2"}\NormalTok{, }\ConstantTok{NA}\NormalTok{,}
    \ConstantTok{NA}\NormalTok{, }\ConstantTok{NA}\NormalTok{, }\ConstantTok{NA}\NormalTok{, }\StringTok{"sigma2e"}
\NormalTok{  ),}
  \AttributeTok{byrow =} \ConstantTok{TRUE}\NormalTok{,}
  \AttributeTok{name =} \StringTok{"mxS"}
\NormalTok{)}
\NormalTok{mxM }\OtherTok{\textless{}{-}}\NormalTok{ OpenMx}\SpecialCharTok{::}\FunctionTok{mxMatrix}\NormalTok{(}
  \AttributeTok{type =} \StringTok{"Full"}\NormalTok{,}
  \AttributeTok{nrow =} \DecValTok{1}\NormalTok{,}
  \AttributeTok{ncol =} \DecValTok{4}\NormalTok{,}
  \AttributeTok{free =} \FunctionTok{c}\NormalTok{(}
\NormalTok{    T, T, T, F}
\NormalTok{  ),}
  \AttributeTok{values =} \FunctionTok{c}\NormalTok{(}
    \FloatTok{0.20}\NormalTok{,}
    \FloatTok{0.20}\NormalTok{,}
    \FloatTok{0.20}\NormalTok{,}
    \DecValTok{0}
\NormalTok{  ),}
  \AttributeTok{labels =} \FunctionTok{c}\NormalTok{(}
    \StringTok{"beta0"}\NormalTok{,}
    \StringTok{"mux1"}\NormalTok{,}
    \StringTok{"mux2"}\NormalTok{,}
    \ConstantTok{NA}
\NormalTok{  ),}
  \AttributeTok{byrow =} \ConstantTok{TRUE}\NormalTok{,}
  \AttributeTok{name =} \StringTok{"mxM"}
\NormalTok{)}
\NormalTok{mxF }\OtherTok{\textless{}{-}}\NormalTok{ OpenMx}\SpecialCharTok{::}\FunctionTok{mxMatrix}\NormalTok{(}
  \AttributeTok{type =} \StringTok{"Full"}\NormalTok{,}
  \AttributeTok{nrow =} \DecValTok{3}\NormalTok{,}
  \AttributeTok{ncol =} \DecValTok{4}\NormalTok{,}
  \AttributeTok{free =} \ConstantTok{FALSE}\NormalTok{,}
  \AttributeTok{values =} \FunctionTok{c}\NormalTok{(}
    \DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{,}
    \DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{,}
    \DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{0}
\NormalTok{  ),}
  \AttributeTok{byrow =} \ConstantTok{TRUE}\NormalTok{,}
  \AttributeTok{name =} \StringTok{"mxF"}
\NormalTok{)}
\NormalTok{expRAM }\OtherTok{\textless{}{-}}\NormalTok{ OpenMx}\SpecialCharTok{::}\FunctionTok{mxExpectationRAM}\NormalTok{(}
  \AttributeTok{A =} \StringTok{"mxA"}\NormalTok{,}
  \AttributeTok{S =} \StringTok{"mxS"}\NormalTok{,}
  \AttributeTok{F =} \StringTok{"mxF"}\NormalTok{,}
  \AttributeTok{M =} \StringTok{"mxM"}\NormalTok{,}
  \AttributeTok{dimnames =} \FunctionTok{c}\NormalTok{(}
    \StringTok{"y"}\NormalTok{,}
    \StringTok{"x1"}\NormalTok{,}
    \StringTok{"x2"}\NormalTok{,}
    \StringTok{"e"}
\NormalTok{  )}
\NormalTok{)}
\NormalTok{objML }\OtherTok{\textless{}{-}}\NormalTok{ OpenMx}\SpecialCharTok{::}\FunctionTok{mxFitFunctionML}\NormalTok{()}
\NormalTok{mxMod }\OtherTok{\textless{}{-}}\NormalTok{ OpenMx}\SpecialCharTok{::}\FunctionTok{mxModel}\NormalTok{(}
  \AttributeTok{name =} \StringTok{"One Way Analysis of Variance"}\NormalTok{,}
  \AttributeTok{data =}\NormalTok{ mxData,}
  \AttributeTok{matrices =} \FunctionTok{list}\NormalTok{(}
\NormalTok{    mxA,}
\NormalTok{    mxS,}
\NormalTok{    mxF,}
\NormalTok{    mxM}
\NormalTok{  ),}
  \AttributeTok{expectation =}\NormalTok{ expRAM,}
  \AttributeTok{fitfunction =}\NormalTok{ objML}
\NormalTok{)}
\NormalTok{fit }\OtherTok{\textless{}{-}}\NormalTok{ OpenMx}\SpecialCharTok{::}\FunctionTok{mxRun}\NormalTok{(mxMod)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Running One Way Analysis of Variance with 8 parameters
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(fit)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Summary of One Way Analysis of Variance 
##  
## free parameters:
##       name matrix row col   Estimate   Std.Error A
## 1    beta1    mxA   1   2 1.98308662 0.064543779  
## 2    beta2    mxA   1   3 0.94883814 0.064543143  
## 3 sigma2x1    mxS   2   2 0.22222230 0.008114416  
## 4 sigma2x2    mxS   3   3 0.22222238 0.008114420  
## 5  sigma2e    mxS   4   4 1.04147460 0.038029458  
## 6    beta0    mxM   1   y 0.03083127 0.045639092  
## 7     mux1    mxM   1  x1 0.33333343 0.012171613  
## 8     mux2    mxM   1  x2 0.33333344 0.012171612  
## 
## Model Statistics: 
##                |  Parameters  |  Degrees of Freedom  |  Fit (-2lnL units)
##        Model:              8                   4492               8319.17
##    Saturated:              9                   4491                    NA
## Independence:              6                   4494                    NA
## Number of observations/statistics: 1500/4500
## 
## Information Criteria: 
##       |  df Penalty  |  Parameters Penalty  |  Sample-Size Adjusted
## AIC:      -664.8302               8335.170                 8335.266
## BIC:    -24531.8162               8377.676                 8352.262
## To get additional fit indices, see help(mxRefModels)
## timestamp: 2021-01-23 23:50:44 
## Wall clock time: 0.03225899 secs 
## optimizer:  SLSQP 
## OpenMx version number: 2.18.1 
## Need help?  See help(mxSummary)
\end{verbatim}

\hypertarget{using-the-ramr-package-3}{%
\subsection{\texorpdfstring{Using the \texttt{ramR} Package}{Using the ramR Package}}\label{using-the-ramr-package-3}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{A}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    y       x1        x2 e
## y  0 2.008444 0.9885797 1
## x1 0 0.000000 0.0000000 0
## x2 0 0.000000 0.0000000 0
## e  0 0.000000 0.0000000 0
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{S}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    y        x1        x2         e
## y  0 0.0000000 0.0000000 0.0000000
## x1 0 0.2223705 0.0000000 0.0000000
## x2 0 0.0000000 0.2223705 0.0000000
## e  0 0.0000000 0.0000000 0.9823083
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{u}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##            u
## y  0.3333333
## x1 0.3333333
## x2 0.3333333
## e  0.0000000
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{filter}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    y x1 x2 e
## y  1  0  0 0
## x1 0  1  0 0
## x2 0  0  1 0
\end{verbatim}

The covariance expectations
can be numerically derived using the \texttt{ramR::C\_num()} function.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ramR}\SpecialCharTok{::}\FunctionTok{C\_num}\NormalTok{(A, S)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##            y        x1        x2         e
## y  2.0966368 0.4466185 0.2198309 0.9823083
## x1 0.4466185 0.2223705 0.0000000 0.0000000
## x2 0.2198309 0.0000000 0.2223705 0.0000000
## e  0.9823083 0.0000000 0.0000000 0.9823083
\end{verbatim}

The covariance expectations for the observed variables
can be numerically derived using the \texttt{ramR::M\_num()} function.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ramR}\SpecialCharTok{::}\FunctionTok{M\_num}\NormalTok{(A, S, filter)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##            y        x1        x2
## y  2.0966368 0.4466185 0.2198309
## x1 0.4466185 0.2223705 0.0000000
## x2 0.2198309 0.0000000 0.2223705
\end{verbatim}

The mean expectations
can be numerically derived using the \texttt{ramR::v\_num()} function.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ramR}\SpecialCharTok{::}\FunctionTok{v\_num}\NormalTok{(A, u)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##            v
## y  1.3323411
## x1 0.3333333
## x2 0.3333333
## e  0.0000000
\end{verbatim}

The mean expectations for the observed variables
can be numerically derived using the \texttt{ramR::v\_num()} function.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ramR}\SpecialCharTok{::}\FunctionTok{g\_num}\NormalTok{(A, u, filter)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##            g
## y  1.3323411
## x1 0.3333333
## x2 0.3333333
\end{verbatim}

\hypertarget{equations-to-ram-1}{%
\section{Equations to RAM}\label{equations-to-ram-1}}

The \texttt{ramR} package has a utility function
to convert structural equations to RAM notation.
One-way analysis of variance with three levels
can be expressed in the following equations

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{eq }\OtherTok{\textless{}{-}} \StringTok{"}
\StringTok{  \# VARIABLE1 OPERATION VARIABLE2 LABEL}
\StringTok{  e           by        y         1}
\StringTok{  y           on        x1        beta1}
\StringTok{  y           on        x2        beta2}
\StringTok{  e           with      e         sigma[varepsilon]\^{}2}
\StringTok{  x1          with      x1        sigma[x1]\^{}2}
\StringTok{  x2          with      x2        sigma[x2]\^{}2}
\StringTok{  y           on        1         beta0}
\StringTok{  x1          on        1         mu[x1]}
\StringTok{  x2          on        1         mu[x2]}
\StringTok{"}
\end{Highlighting}
\end{Shaded}

\begin{figure}
\centering
\includegraphics{ramR_notes_files/figure-latex/ram-aov-02-1.pdf}
\caption{\label{fig:ram-aov-02}One-Way Analysis of Variance's Structural Equations}
\end{figure}

The error term is treated as a latent variable
and defined with the operation \texttt{by}.
Its value is constrained to \(1\).
The regression of \(y\) on \(x_1\) and \(x_2\) is defined by operation \texttt{on}.
The coefficients are labeled as \texttt{beta{[}1{]}} and \texttt{beta{[}2{]}} respectively.
The variance of \(x_1\), \(x_2\) and the error variance
are defined using the operation \texttt{with}.
These are labeled \texttt{sigma{[}x1{]}\^{}2}, \texttt{sigma{[}x2{]}\^{}2}, and \texttt{sigma{[}varepsilon{]}\^{}2} respectively.
The intercept and the mean of \(x_1\) and \(x_2\) are defined using the operation \texttt{on\ 1}.
These are labeled \texttt{beta{[}0{]}}, \texttt{mu{[}x1{]}}, and \texttt{mu{[}x2{]}} respectively.

The \texttt{ramR::eq2ram} converts the equations to RAM notation.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ramR}\SpecialCharTok{::}\FunctionTok{eq2ram}\NormalTok{(eq)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## $eq
##   var1   op var2               label
## 1    e   by    y                   1
## 2    y   on   x1               beta1
## 3    y   on   x2               beta2
## 4    e with    e sigma[varepsilon]^2
## 5   x1 with   x1         sigma[x1]^2
## 6   x2 with   x2         sigma[x2]^2
## 7    y   on    1               beta0
## 8   x1   on    1              mu[x1]
## 9   x2   on    1              mu[x2]
## 
## $variables
## [1] "y"  "x1" "x2" "e" 
## 
## $A
##    y   x1      x2      e  
## y  "0" "beta1" "beta2" "1"
## x1 "0" "0"     "0"     "0"
## x2 "0" "0"     "0"     "0"
## e  "0" "0"     "0"     "0"
## 
## $S
##    y   x1            x2            e                    
## y  "0" "0"           "0"           "0"                  
## x1 "0" "sigma[x1]^2" "0"           "0"                  
## x2 "0" "0"           "sigma[x2]^2" "0"                  
## e  "0" "0"           "0"           "sigma[varepsilon]^2"
## 
## $filter
##    y x1 x2 e
## y  1  0  0 0
## x1 0  1  0 0
## x2 0  0  1 0
## 
## $u
##    u       
## y  "beta0" 
## x1 "mu[x1]"
## x2 "mu[x2]"
## e  "0"
\end{verbatim}

\hypertarget{equations-to-expectations-1}{%
\section{Equations to Expectations}\label{equations-to-expectations-1}}

The \texttt{ramR} package has a utility function
to convert structural equations to expectations
both symbolically and numerically.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{eq }\OtherTok{\textless{}{-}} \StringTok{"}
\StringTok{  \# VARIABLE1 OPERATION VARIABLE2 LABEL}
\StringTok{  e           by        y         1}
\StringTok{  y           on        x1        beta1}
\StringTok{  y           on        x2        beta2}
\StringTok{  e           with      e         sigma[varepsilon]\^{}2}
\StringTok{  x1          with      x1        sigma[x1]\^{}2}
\StringTok{  x2          with      x2        sigma[x2]\^{}2}
\StringTok{  y           on        1         beta0}
\StringTok{  x1          on        1         mu[x1]}
\StringTok{  x2          on        1         mu[x2]}
\StringTok{"}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ramR}\SpecialCharTok{::}\FunctionTok{eq2exp\_sym}\NormalTok{(eq)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## $variables
## [1] "y"  "x1" "x2" "e" 
## 
## $A
## {{    0, beta1, beta2,     1},
##  {    0,     0,     0,     0},
##  {    0,     0,     0,     0},
##  {    0,     0,     0,     0}} 
## 
## $S
## {{                  0,                   0,                   0,                   0},
##  {                  0,         sigma[x1]^2,                   0,                   0},
##  {                  0,                   0,         sigma[x2]^2,                   0},
##  {                  0,                   0,                   0, sigma[varepsilon]^2}} 
## 
## $u
## {{ beta0},
##  {mu[x1]},
##  {mu[x2]},
##  {     0}} 
## 
## $filter
## {{1, 0, 0, 0},
##  {0, 1, 0, 0},
##  {0, 0, 1, 0}} 
## 
## $v
## {{beta0+beta1*mu[x1]+beta2*mu[x2]},
##  {                         mu[x1]},
##  {                         mu[x2]},
##  {                              0}} 
## 
## $g
## {{beta0+beta1*mu[x1]+beta2*mu[x2]},
##  {                         mu[x1]},
##  {                         mu[x2]}} 
## 
## $C
## {{sigma[x1]^2*beta1^2+sigma[x2]^2*beta2^2+sigma[varepsilon]^2,                                           beta1*sigma[x1]^2,                                           beta2*sigma[x2]^2,                                         sigma[varepsilon]^2},
##  {                                          sigma[x1]^2*beta1,                                                 sigma[x1]^2,                                                           0,                                                           0},
##  {                                          sigma[x2]^2*beta2,                                                           0,                                                 sigma[x2]^2,                                                           0},
##  {                                        sigma[varepsilon]^2,                                                           0,                                                           0,                                         sigma[varepsilon]^2}} 
## 
## $M
## {{sigma[x1]^2*beta1^2+sigma[x2]^2*beta2^2+sigma[varepsilon]^2,                                           beta1*sigma[x1]^2,                                           beta2*sigma[x2]^2},
##  {                                          sigma[x1]^2*beta1,                                                 sigma[x1]^2,                                                           0},
##  {                                          sigma[x2]^2*beta2,                                                           0,                                                 sigma[x2]^2}}
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{eq }\OtherTok{\textless{}{-}} \StringTok{"}
\StringTok{  \# VARIABLE1 OPERATION VARIABLE2 LABEL}
\StringTok{  e           by        y         1}
\StringTok{  y           on        x1        2}
\StringTok{  y           on        x2        1}
\StringTok{  e           with      e         1}
\StringTok{  x1          with      x1        0.22222222222}
\StringTok{  x2          with      x2        0.22222222222}
\StringTok{  y           on        1         0}
\StringTok{  x1          on        1         0.33333333333}
\StringTok{  x2          on        1         0.33333333333}
\StringTok{"}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ramR}\SpecialCharTok{::}\FunctionTok{eq2exp\_num}\NormalTok{(eq)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## $variables
## [1] "y"  "x1" "x2" "e" 
## 
## $A
##    y x1 x2 e
## y  0  2  1 1
## x1 0  0  0 0
## x2 0  0  0 0
## e  0  0  0 0
## 
## $S
##    y        x1        x2 e
## y  0 0.0000000 0.0000000 0
## x1 0 0.2222222 0.0000000 0
## x2 0 0.0000000 0.2222222 0
## e  0 0.0000000 0.0000000 1
## 
## $u
##            u
## y  0.0000000
## x1 0.3333333
## x2 0.3333333
## e  0.0000000
## 
## $filter
##    y x1 x2 e
## y  1  0  0 0
## x1 0  1  0 0
## x2 0  0  1 0
## 
## $v
##            v
## y  1.0000000
## x1 0.3333333
## x2 0.3333333
## e  0.0000000
## 
## $g
##            g
## y  1.0000000
## x1 0.3333333
## x2 0.3333333
## 
## $C
##            y        x1        x2 e
## y  2.1111111 0.4444444 0.2222222 1
## x1 0.4444444 0.2222222 0.0000000 0
## x2 0.2222222 0.0000000 0.2222222 0
## e  1.0000000 0.0000000 0.0000000 1
## 
## $M
##            y        x1        x2
## y  2.1111111 0.4444444 0.2222222
## x1 0.4444444 0.2222222 0.0000000
## x2 0.2222222 0.0000000 0.2222222
\end{verbatim}

\hypertarget{ram-two-reg}{%
\chapter{Two-Variable Regression Model}\label{ram-two-reg}}

\begin{figure}
\centering
\includegraphics{ramR_notes_files/figure-latex/ram-two-reg-01-1.pdf}
\caption{\label{fig:ram-two-reg-01}Two-Variable Regression Model}
\end{figure}

\hypertarget{ram-k-reg}{%
\chapter{\texorpdfstring{\(k\)-Variable Regression Model}{k-Variable Regression Model}}\label{ram-k-reg}}

\begin{figure}
\centering
\includegraphics{ramR_notes_files/figure-latex/ram-k-reg-01-1.pdf}
\caption{\label{fig:ram-k-reg-01}\(k\)-Variable Regression Model}
\end{figure}

\hypertarget{ram-med-simple}{%
\chapter{The Simple Mediation Model}\label{ram-med-simple}}

\begin{figure}
\centering
\includegraphics{ramR_notes_files/figure-latex/ram-med-simple-01-1.pdf}
\caption{\label{fig:ram-med-simple-01}The Simple Mediation Model}
\end{figure}

\hypertarget{ram-med-simple-std}{%
\chapter{The Standardized Simple Mediation Model}\label{ram-med-simple-std}}

\begin{figure}
\centering
\includegraphics{ramR_notes_files/figure-latex/ram-med-simple-std-01-1.pdf}
\caption{\label{fig:ram-med-simple-std-01}The Standardized Simple Mediation Model}
\end{figure}

  \bibliography{book.bib,packages.bib}

\end{document}
